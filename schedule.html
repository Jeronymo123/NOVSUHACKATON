<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Расписание - UniAttend</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .schedule-container {
            max-width: 1200px;
            width: 100%;
            margin: 100px auto 2rem;
            padding: 0 2rem;
        }

        .schedule-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .schedule-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .week-navigation {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .schedule-table {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .schedule-day {
            border-bottom: 1px solid var(--border);
        }

        .schedule-day:last-child {
            border-bottom: none;
        }

        .day-header {
            background: var(--primary);
            color: white;
            padding: 1rem 1.5rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .day-content {
            padding: 1rem 1.5rem;
        }

        .lesson-card {
            background: var(--background);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid var(--primary);
        }

        .lesson-card:last-child {
            margin-bottom: 0;
        }

        .lesson-time {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .lesson-info {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            align-items: center;
        }

        .lesson-details h4 {
            margin-bottom: 0.25rem;
            color: var(--text);
        }

        .lesson-meta {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .lesson-actions {
            display: flex;
            gap: 0.5rem;
        }

        .empty-schedule {
            text-align: center;
            padding: 3rem;
            color: var(--text-light);
        }

        .empty-schedule i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--border);
        }

        @media (max-width: 768px) {
            .schedule-container {
                margin-top: 120px;
                padding: 0 1rem;
            }

            .schedule-header {
                flex-direction: column;
                align-items: stretch;
            }

            .lesson-info {
                grid-template-columns: 1fr;
            }

            .lesson-actions {
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <a href="dashboard.html" class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span>UniAttend</span>
            </a>
            <ul class="nav-links">
                <li><a href="dashboard.html">Главная</a></li>
                <li><a href="table.html">Посещаемость</a></li>
                <li><a href="schedule.html" class="active">Расписание</a></li>
            </ul>
            <div class="auth-buttons">
                <a href="profile.html" class="btn btn-secondary">
                    <i class="fas fa-user-circle"></i><p id="NameProfile">Проф. Иванов А.С.</p>
                </a>
                <a href="entry_form.html" class="btn btn-primary" id="Logout">Выйти</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="schedule-container">
            <div class="schedule-header">
                <h1 style="color: var(--text); margin: 0;">Расписание занятий</h1>
                <div class="schedule-controls">
                    <div class="week-navigation">
                        <button class="btn btn-secondary" onclick="changeWeek(-1)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="currentWeek" style="font-weight: 600; min-width: 200px; text-align: center;"></span>
                        <button class="btn btn-secondary" onclick="changeWeek(1)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <button class="btn btn-primary" onclick="loadScheduleData()">
                        <i class="fas fa-sync-alt"></i> Обновить
                    </button>
                </div>
            </div>

            <div class="schedule-table" id="scheduleTable">
                <!-- Расписание будет загружено через JavaScript -->
                <div class="empty-schedule">
                    <i class="fas fa-calendar-alt"></i>
                    <h3>Расписание загружается...</h3>
                    <p>Данные будут загружены из системы</p>
                </div>
            </div>
        </div>
        <script src="scriptSchedule.js" type="module"></script>
    </main>

    <footer>
        <div class="footer-content">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span>UniAttend</span>
            </div>
            <p>&copy; 2025 Система учёта посещаемости. Все права защищены.</p>
        </div>
    </footer>

    <script>
        let currentWeekOffset = 0;

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            updateWeekDisplay();
            loadScheduleData();
        });

        // Функция для изменения недели
        function changeWeek(direction) {
            currentWeekOffset += direction;
            updateWeekDisplay();
            loadScheduleData();
        }

        // Обновление отображения текущей недели
        function updateWeekDisplay() {
            const now = new Date();
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay() + 1 + (currentWeekOffset * 7));
            
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);

            const weekDisplay = document.getElementById('currentWeek');
            weekDisplay.textContent = 
                `${startOfWeek.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })} - ` +
                `${endOfWeek.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long', year: 'numeric' })}`;
        }

        // Загрузка данных расписания
        async function loadScheduleData() {
            const scheduleTable = document.getElementById('scheduleTable');
            
            try {
                // В реальной системе здесь будет fetch запрос к API
                // Сейчас используем демо-данные
                const scheduleData = await getDemoScheduleData();
                renderSchedule(scheduleData);
            } catch (error) {
                console.error('Ошибка загрузки расписания:', error);
                scheduleTable.innerHTML = `
                    <div class="empty-schedule">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Ошибка загрузки расписания</h3>
                        <p>Попробуйте обновить страницу</p>
                    </div>
                `;
            }
        }

        // Демо-данные расписания (в реальной системе будут из JSON)
        // Демо-данные расписания (в реальной системе будут из JSON)
async function getDemoScheduleData() {
    // Имитация загрузки данных
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve({
                days: [
                    {
                        day: 'Понедельник',
                        date: '2024-12-16',
                        lessons: [
                            {
                                time: '09:00 - 10:30',
                                subject: 'Веб-разработка',
                                type: 'Лекция',
                                group: 'ПИ-201',
                                classroom: 'А-101'
                            },
                            {
                                time: '11:00 - 12:30',
                                subject: 'Алгоритмы и структуры данных',
                                type: 'Практика',
                                group: 'ПИ-201',
                                classroom: 'Б-205'
                            }
                        ]
                    },
                    {
                        day: 'Вторник',
                        date: '2024-12-17',
                        lessons: [
                            {
                                time: '13:00 - 14:30',
                                subject: 'Базы данных',
                                type: 'Лабораторная',
                                group: 'ПИ-201',
                                classroom: 'К-301'
                            },
                            {
                                time: '15:00 - 16:30',
                                subject: 'Операционные системы',
                                type: 'Лекция',
                                group: 'ПИ-201',
                                classroom: 'А-103'
                            }
                        ]
                    },
                    {
                        day: 'Среда',
                        date: '2024-12-18',
                        lessons: [
                            {
                                time: '10:00 - 11:30',
                                subject: 'Математический анализ',
                                type: 'Лекция',
                                group: 'ПИ-201',
                                classroom: 'А-102'
                            },
                            {
                                time: '12:00 - 13:30',
                                subject: 'Иностранный язык',
                                type: 'Практика',
                                group: 'ПИ-201',
                                classroom: 'Л-201'
                            }
                        ]
                    },
                    {
                        day: 'Четверг',
                        date: '2024-12-19',
                        lessons: [
                            {
                                time: '14:00 - 15:30',
                                subject: 'Архитектура компьютеров',
                                type: 'Лекция',
                                group: 'ПИ-201',
                                classroom: 'А-104'
                            },
                            {
                                time: '16:00 - 17:30',
                                subject: 'Физическая культура',
                                type: 'Практика',
                                group: 'ПИ-201',
                                classroom: 'Спортзал'
                            }
                        ]
                    },
                    {
                        day: 'Пятница',
                        date: '2024-12-20',
                        lessons: [
                            {
                                time: '09:00 - 10:30',
                                subject: 'Теория вероятностей',
                                type: 'Лекция',
                                group: 'ПИ-201',
                                classroom: 'А-105'
                            },
                            {
                                time: '11:00 - 12:30',
                                subject: 'Проектный практикум',
                                type: 'Лабораторная',
                                group: 'ПИ-201',
                                classroom: 'К-302'
                            },
                            {
                                time: '13:00 - 14:30',
                                subject: 'Философия',
                                type: 'Лекция',
                                group: 'ПИ-201',
                                classroom: 'А-106'
                            }
                        ]
                    },
                    {
                        day: 'Суббота',
                        date: '2024-12-21',
                        lessons: [] // Нет занятий в субботу
                    },
                    {
                        day: 'Воскресенье', 
                        date: '2024-12-22',
                        lessons: [] // Нет занятий в воскресенье
                    }
                ]
            });
        }, 500);
    });
}

        // Рендеринг расписания
        function renderSchedule(data) {
            const scheduleTable = document.getElementById('scheduleTable');
            
            if (!data.days || data.days.length === 0) {
                scheduleTable.innerHTML = `
                    <div class="empty-schedule">
                        <i class="fas fa-calendar-times"></i>
                        <h3>Нет занятий на эту неделю</h3>
                        <p>Расписание не найдено</p>
                    </div>
                `;
                return;
            }

            let scheduleHTML = '';

            data.days.forEach(day => {
                scheduleHTML += `
                    <div class="schedule-day">
                        <div class="day-header">
                            <span>${day.day}</span>
                            <span>${new Date(day.date).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })}</span>
                        </div>
                        <div class="day-content">
                            ${day.lessons.length > 0 ? 
                                day.lessons.map(lesson => `
                                    <div class="lesson-card">
                                        <div class="lesson-time">${lesson.time}</div>
                                        <div class="lesson-info">
                                            <div class="lesson-details">
                                                <h4>${lesson.subject}</h4>
                                                <div class="lesson-meta">
                                                    ${lesson.type} | ${lesson.group} | ${lesson.classroom}
                                                </div>
                                            </div>
                                            <div class="lesson-actions">
                                                <button class="btn btn-secondary" onclick="startAttendance('${lesson.time}', '${lesson.subject}')">
                                                    <i class="fas fa-qrcode"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `).join('') : 
                                '<div style="text-align: center; color: var(--text-light); padding: 2rem;">Нет занятий</div>'
                            }
                        </div>
                    </div>
                `;
            });

            scheduleTable.innerHTML = scheduleHTML;
        }

        // Функция для начала отметки посещаемости
        function startAttendance(time, subject) {
            alert(`Запуск отметки посещаемости для:\n${subject}\n${time}\n\nQR-код будет сгенерирован для студентов.`);
        }
    </script>
</body>
</html>